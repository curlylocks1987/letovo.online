# Retention и когортный анализ по итогам 2021-2022 учебного года.

Letovo.online. Июнь 2022.

## Данные

Таблица __users__ (данные о пользователях платформы):
- `id` -- внутренний id пользователя в системе
- `grade_id` -- актуальный класс ученика на апрель 2022.
- `created_at` -- дата создания пользователя
- `role` -- выбираем learner (ученики собственно)
- `id___global` -- внешний ID, в некоторых таблицах он используется 
- `ts_login_first` -- первый логин в ДО. Может не совпадать с created_at, так как пользователь мог зарегаться на сайте школы и не перейти в ДО 
- `ts_login_last` -- последний логин в ДО

Таблица __auth__ (данные об авторизациях пользователей):
- `id_app` -- выбираем (2)
- `idc_type` -- выбираем (1) и (2) 
- `idc_audit_access` -- (1)
- `id_user_login` -- это обычный id внутренний в users
- `ti` -- время 
- `f_supervisor` -- выбираем (0)

Это две основные таблицы. Кроме того есть таблицы с данными по тестам, курсам, олипиадам, а также по заявкам в школу.

## Задача

1. **Кривая Retention и усредненный процент по дням (1-30), месяцам (1-24) по сегментам**: 

    - все новые пользователи
    - пользователи, которые начали тест в течение 14 дней после первого логина
    - пользователи, которые закончили тест в течение 14 дней после первого логина

    - пользователи, которые подали заявку на курс в течение 14 дней после первого логина
    - пользователи, которые получили одобренную заявку на курс в течение 45 дней после подачи заявки
    - пользователи, которые получили отказ
    - пользователи, которые подали заявку на обучение в школе
    
2. **Когортный анализ по неделям для новых пользователей в 2021-2022 гг.** 
    1. Число новых пользователей в когорте 
    2. Начали проходить тест в течение 14 дней после регистрации
    3. Закончили проходить тест в течение 30 дней после регистрации
    4. Подали заявку на курс в течение 14 дней после регистрации
    5. Решили одно олимпиадное задание в течение 14 дней 
    6. Подали заявку в школу 
    7. Retention новых пользователей в авторизацию на 1, 7 и 30 день    
 
Замечание: смотрим __только на 5-8 классы__.

## Используемые библиотеки
*pandas*, *seaborn*, *matplotlib*, *numpy*, *lxml*

## Основные выводы

- Retention имеет тенденцию к росту при переходе по цепочке: логин -> нач. тест -> закон. тест. Заявка на курс в плане retention лучше, чем начавшие тест, но хуже, чем те, кто тест завершил.
- есть тенденция на снижение с 2019 до 2021 года
- сезонные пики: май, июнь, июль ,август, сентябрь, октябрь, ноябрь, декабрь, январь - высокий сезон, особенно выраженный в сентябре-октябре, что логично.
- Конверсия в заявку на курс совсем низкая, ниже, чем на олимпиады
- В ноябре и декабре всплеск заявок на олимпиады
- Высокий процент заявок на курс видим только в сентябре и начале октября
- Самая высокая конверсия в заявку на обучение в школе на вторую неделю октября (33%)